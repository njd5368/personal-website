(()=>{"use strict";var e=function(e,t,n,i){return new(n||(n=Promise))((function(l,s){function u(e){try{o(i.next(e))}catch(e){s(e)}}function r(e){try{o(i.throw(e))}catch(e){s(e)}}function o(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(u,r)}o((i=i.apply(e,t||[])).next())}))};function t(e,t,n){let i=[];for(let l=0;l<e.length;l+=2){let s=2*Math.PI/t;for(let t=0;t<=2*Math.PI;t+=s)i=i.concat([e[l],e[l+1],Math.sin(t)*n+e[l],Math.cos(t)*n+e[l+1],Math.sin(t+s)*n+e[l],Math.cos(t+s)*n+e[l+1]])}return i}class n{constructor(e,t,n,i,l,s,u){this.type=e,this.offset=t,this.count=n,this.red=i,this.green=l,this.blue=s,this.alpha=u}}function i(e,i,l,s=null,u=[],o=null,h=[],a=[],c=null,p=0,f=!0){let d=function(e,t){const n=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(n," attribute vec4 aVertexPosition;\n\nvoid main() {\n  gl_Position = aVertexPosition;\n}"),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))return n;console.log(e.getShaderInfoLog(n)),e.deleteShader(n)}(e),g=function(e,t){const n=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(n,"precision mediump float;\nuniform vec4 vColor;\nuniform int point;\n\nvoid main() {\n\n  gl_FragColor = vColor;\n}\n\n"),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS))return n;console.log(e.getShaderInfoLog(n)),e.deleteShader(n)}(e),m=function(e,t,n){let i=e.createProgram();if(e.attachShader(i,t),e.attachShader(i,n),e.linkProgram(i),e.getProgramParameter(i,e.LINK_STATUS))return i;console.log(e.getProgramInfoLog(i)),e.deleteProgram(i)}(e,d,g),y=e.getAttribLocation(m,"aVertexPosition"),v=e.getUniformLocation(m,"vColor"),b=e.getUniformLocation(m,"point"),E=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,E);let A=[],w=[],x=0;if(0!=h.length){let t=[];for(let e of h)t.push(e.p1.x,e.p1.y,e.p2.x,e.p2.y,e.p3.x,e.p3.y);A=A.concat(t),w.push(new n(e.TRIANGLES,x,t.length/2,.98,.702,.529,.1)),x+=t.length/2}let q=[],S=[];if(null!=c){let t=64;p>1024&&(t=p*Math.PI/64);let i=2*Math.PI/t;for(let e=0;e<=2*Math.PI;e+=i){let t=Math.sin(e)*p+c.x,n=Math.cos(e)*p+c.y,l=Math.sin(e+i)*p+c.x,s=Math.cos(e+i)*p+c.y;q.push(t,n,l,s),S.push(c.x,c.y,t,n,l,s)}A=A.concat(S),A=A.concat(q),f?(w.push(new n(e.TRIANGLES,x,S.length/2,.651,.89,.631,.33)),w.push(new n(e.LINES,x+S.length/2,q.length/2,.651,.89,.631,1))):(w.push(new n(e.TRIANGLES,x,S.length/2,.98,.702,.529,.33)),w.push(new n(e.LINES,x+S.length/2,q.length/2,.98,.702,.529,1))),x+=q.length/2+S.length/2}if(A=A.concat(i),w.push(new n(e.LINES,x,i.length/2,.537,.706,.98,1)),x+=i.length/2,null!=s){console.log("TRIANGLE");let t=r([s]);A=A.concat(t),w.push(new n(e.LINES,x,t.length/2,.976,.886,.686,1)),x+=t.length/2}if(0!=a.length){let t=[];for(let e of a)t.push(e[0].x,e[0].y,e[1].x,e[1].y);A=A.concat(t),w.push(new n(e.LINES,x,t.length/2,.651,.89,.631,1)),x+=t.length/2}if(0!=u.length){let t=[];t.push(u[0].x,u[0].y,u[1].x,u[1].y),A=A.concat(t),w.push(new n(e.LINES,x,t.length/2,.953,.545,.659,1)),x+=t.length/2}let N=t(l,12,.02);if(A=A.concat(N),w.push(new n(e.TRIANGLES,x,N.length/2,.953,.545,.659,1)),x+=N.length/2,null!=o){let i=t([o.x,o.y],12,.02);A=A.concat(i),w.push(new n(e.TRIANGLES,x,i.length/2,.976,.886,.686,1)),x+=i.length/2}e.bufferData(e.ARRAY_BUFFER,new Float32Array(A),e.STATIC_DRAW),e.viewport(0,0,e.canvas.width,e.canvas.height),e.clearColor(.094,.094,.145,1),e.clear(e.COLOR_BUFFER_BIT),e.useProgram(m),e.enableVertexAttribArray(y),e.bindBuffer(e.ARRAY_BUFFER,E);let L=e.FLOAT;e.vertexAttribPointer(y,2,L,!1,0,0),e.uniform1i(b,1);for(let t of w)e.uniform4f(v,t.red,t.green,t.blue,t.alpha),e.drawArrays(t.type,t.offset,t.count)}class l{constructor(e,t,n){this.x=e,this.y=t,this.z=n}cmult(e){return new l(this.x*e,this.y*e,this.z*e)}add(e){return new l(this.x+e.x,this.y+e.y,this.z+e.z)}sub(e){return this.add(e.cmult(-1))}equals(e){return this.x==e.x&&this.y==e.y&&this.z==e.z}mag(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))}cross(e){return new l(this.y*e.z-this.z*e.y,this.x*e.z-this.z*e.x,this.x*e.y-this.y*e.x)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}pair(){return[this.x,this.y]}}class s{constructor(e,t,n){this.p1=e,this.p2=t,this.p3=n}equals(e){return this.p1.equals(e.p1)&&this.p2.equals(e.p2)&&this.p3.equals(e.p3)||this.p1.equals(e.p1)&&this.p2.equals(e.p3)&&this.p3.equals(e.p2)||this.p1.equals(e.p2)&&this.p2.equals(e.p1)&&this.p3.equals(e.p3)||this.p1.equals(e.p2)&&this.p2.equals(e.p3)&&this.p3.equals(e.p1)||this.p1.equals(e.p3)&&this.p2.equals(e.p1)&&this.p3.equals(e.p2)||this.p1.equals(e.p3)&&this.p2.equals(e.p2)&&this.p3.equals(e.p1)}hasCommmonVertex(e){return this.p1.equals(e.p1)||this.p2.equals(e.p1)||this.p3.equals(e.p1)||this.p1.equals(e.p2)||this.p2.equals(e.p2)||this.p3.equals(e.p2)||this.p1.equals(e.p3)||this.p2.equals(e.p3)||this.p3.equals(e.p3)}getEdges(){return[[this.p1,this.p2],[this.p2,this.p3],[this.p3,this.p1]]}getCircumradius(){return this.p1.sub(this.p2).mag()*this.p2.sub(this.p3).mag()*this.p3.sub(this.p1).mag()/(2*this.p1.sub(this.p2).cross(this.p2.sub(this.p3)).mag())}getCircumcenter(){let e=2*Math.pow(this.p1.sub(this.p2).cross(this.p2.sub(this.p3)).mag(),2),t=Math.pow(this.p2.sub(this.p3).mag(),2)*this.p1.sub(this.p3).dot(this.p1.sub(this.p2))/e,n=Math.pow(this.p1.sub(this.p3).mag(),2)*this.p2.sub(this.p3).dot(this.p2.sub(this.p1))/e,i=Math.pow(this.p1.sub(this.p2).mag(),2)*this.p3.sub(this.p1).dot(this.p3.sub(this.p2))/e;return this.p1.cmult(t).add(this.p2.cmult(n)).add(this.p3.cmult(i))}inCircumscribe(e){return this.getCircumcenter().sub(e).mag()<this.getCircumradius()}hasEdge(e,t){return(this.p1.equals(e)||this.p2.equals(e)||this.p3.equals(e))&&(this.p1.equals(t)||this.p2.equals(t)||this.p3.equals(t))&&!e.equals(t)}}function u(e,t){for(let n=0;n<e.length;n++)if(e[n].equals(t))return n;return-1}function r(e){let t=[];for(let n of e)for(let e of n.getEdges())t.push(e[0].x,e[0].y,e[1].x,e[1].y);return t}function o(t,n,i=0){return e(this,void 0,void 0,(function*(){let e=document.getElementById(t);e.style.outline="solid",e.style.outlineWidth="4px",e.style.outlineColor="#89b4fa",yield h(n,i),e.style.outline="2px solid transparent",e.style.outlineOffset="2px"}))}function h(t,n=0){return e(this,void 0,void 0,(function*(){let e;t.addEventListener("click",(function(){e(0)})),document.addEventListener("cancelStep",(function(){e(0)})),document.addEventListener("playPause",(function(){e(0==n?0:1)}));let i=new Promise((t=>{0!=n&&setTimeout(t,n),e=t})),l=!1;yield i.then((e=>{l=1==e})),l&&(yield h(t))}))}function a(t,n,h=!1,a=!1,c=new HTMLElement,p=new HTMLInputElement){return e(this,void 0,void 0,(function*(){document.addEventListener("cancelStep",(function(){h=!1})),document.addEventListener("playPause",(function(){a=!a,console.log("PLAYING")}));let e=[],f=[];if(h){i(t,[],n);let e=0;if(a&&(e=1700-p.valueAsNumber,console.log("value: "+p.valueAsNumber)),yield o("line02",c,e),!h)return[]}if(n.length<2)return f;let d=n[0],g=d,m=n[1],y=m;for(let t=0;t<n.length;t+=2)n[t]<d&&(d=n[t]),n[t]>g&&(g=n[t]),n[t+1]<m&&(m=n[t+1]),n[t+1]>y&&(y=n[t+1]),e.push(new l(n[t],n[t+1],0));let v=new l(d-1e6,m-1e6,0),b=new l(g+1e6,m-1e6,0),E=new l(Math.floor((d+g)/2),y+1e6,0),A=new s(v,b,E);if(f.push(A),h){i(t,r(f),n);let e=0;if(a&&(e=1700-p.valueAsNumber),yield o("line03",c,e),!h)return[]}let w=[];for(let n of e){if(w.push(n.x,n.y),h){i(t,r(f),w,null,[],n);let e=0;if(a&&(e=1700-p.valueAsNumber),yield o("line04",c,e),!h)return[]}let e=[];if(h){i(t,r(f),w,null,[],n);let e=0;if(a&&(e=1700-p.valueAsNumber),yield o("line05",c,e),!h)return[]}for(let l of f){if(h){i(t,r(f),w,l,[],n,e);let s=0;if(a&&(s=1700-p.valueAsNumber),yield o("line06",c,s),!h)return[]}let s=l.inCircumscribe(n);if(h){i(t,r(f),w,l,[],n,e,[],l.getCircumcenter(),l.getCircumradius(),!s);let u=0;if(a&&(u=1700-p.valueAsNumber),yield o("line07",c,u),!h)return[]}if(s&&(e.push(l),h)){i(t,r(f),w,l,[],n,e);let s=0;if(a&&(s=1700-p.valueAsNumber),yield o("line08",c,s),!h)return[]}}let l=[];if(h){i(t,r(f),w,null,[],n,e,l);let s=0;if(a&&(s=1700-p.valueAsNumber),yield o("line09",c,s),!h)return[]}for(let s of e){if(h){i(t,r(f),w,s,[],n,e,l);let u=0;if(a&&(u=1700-p.valueAsNumber),yield o("line10",c,u),!h)return[]}for(let u of s.getEdges()){if(h){i(t,r(f),w,s,u,n,e,l);let d=0;if(a&&(d=1700-p.valueAsNumber),yield o("line11",c,d),!h)return[]}let d=!1;for(let t of e)!s.equals(t)&&t.hasEdge(u[0],u[1])&&(d=!0);if(h){i(t,r(f),w,s,u,n,e,l);let d=0;if(a&&(d=1700-p.valueAsNumber),yield o("line12",c,d),!h)return[]}if(!d&&(l.push(u),h)){i(t,r(f),w,s,[],n,e,l);let u=0;if(a&&(u=1700-p.valueAsNumber),yield o("line13",c,u),!h)return[]}}}let d=e.concat();for(let s of e){if(h){i(t,r(f),w,s,[],n,d,l);let e=0;if(a&&(e=1700-p.valueAsNumber),yield o("line14",c,e),!h)return[]}const e=u(f,s);if(e>-1?f.splice(e,1):console.log("Unable to remove triangle from array!"),h){const e=u(d,s);e>-1?d.splice(e,1):console.log("Unable to remove triangle from array!"),i(t,r(f),w,null,[],n,d,l);let g=0;if(a&&(g=1700-p.valueAsNumber),yield o("line15",c,g),!h)return[]}}for(let e of l){if(h){i(t,r(f),w,null,e,n,[],l);let s=0;if(a&&(s=1700-p.valueAsNumber),yield o("line16",c,s),!h)return[]}let u=new s(e[0],e[1],n);if(h){i(t,r(f),w,u,e,n,[],l);let s=0;if(a&&(s=1700-p.valueAsNumber),yield o("line17",c,s),!h)return[]}if(f.push(u),h){i(t,r(f),w,null,[],n,[],l);let e=0;if(a&&(e=1700-p.valueAsNumber),yield o("line18",c,e),!h)return[]}}}let x=[],q=0;for(;q<f.length;){let e=f[q];if(h){i(t,r(f),w,e);let n=0;if(a&&(n=1700-p.valueAsNumber),yield o("line19",c,n),!h)return[]}if(h){i(t,r(f),w,e);let n=0;if(a&&(n=1700-p.valueAsNumber),yield o("line20",c,n),!h)return[]}if(e.hasCommmonVertex(A)){const n=u(f,e);if(n>-1?f.splice(n,1):console.log("Unable to remove triangle from array!"),h){i(t,r(f),w);let e=0;if(a&&(e=1700-p.valueAsNumber),yield o("line21",c,e),!h)return[]}}else{for(let t of e.getEdges())x.push(t[0].x,t[0].y,t[1].x,t[1].y);q++}}if(h){i(t,r(f),w);let e=0;if(a&&(e=1700-p.valueAsNumber),yield o("line22",c,e),!h)return[]}i(t,x,n)}))}function c(e,t){e.style.display="block",t.style.display="none"}!function(){const t=document.querySelector("canvas"),n=t.getContext("webgl",{premultipliedAlpha:!1});let l=[],s=[];i(n,l,s);const u=document.getElementById("triangulate"),r=document.getElementById("step"),o=document.getElementById("next"),h=document.getElementById("clear"),p=document.getElementById("play"),f=document.getElementById("pause"),d=document.getElementById("speedSlider");let g=!1,m=new Event("cancelStep"),y=new Event("playPause");t.onmousedown=function(e){g=!1,document.dispatchEvent(m),console.log("offsetX:"+e.offsetX),console.log("offsetY:"+e.offsetY),t.width=t.clientWidth,t.height=t.clientHeight;let u=(-t.width/2+e.offsetX)/(t.width/2),r=(t.height/2-e.offsetY)/(t.height/2);console.log("X: "+u),console.log("Y: "+r),s=s.concat([u,r]),i(n,l,s)},u.addEventListener("click",(function(){g=!1,document.dispatchEvent(m),a(n,s,!1,!1,o,d),c(r,o),c(p,f)})),r.addEventListener("click",(function(){return e(this,void 0,void 0,(function*(){g=!0,c(o,r),yield a(n,s,!0,!1,o,d),c(r,o),c(p,f),g=!1}))})),h.addEventListener("click",(function(){g=!1,document.dispatchEvent(m),l=[],s=[],i(n,l,s),c(r,o),c(p,f)})),p.addEventListener("click",(function(){return e(this,void 0,void 0,(function*(){g?(document.dispatchEvent(y),c(f,p)):(g=!0,c(o,r),c(f,p),yield a(n,s,!0,!0,o,d),c(r,o),c(p,f),g=!1)}))})),f.addEventListener("click",(function(){c(p,f),document.dispatchEvent(y)}))}()})();